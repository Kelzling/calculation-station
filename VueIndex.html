<!DOCTYPE html>
<head>
  <title>Calculator</title>
  <link rel="stylesheet" href="css\stylesheet.css"></link>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="src/VueController.js"></script>   
  <script src="src/CorrelationCalculator.js"></script>
  <script src="src/RegressionCalculator.js"></script>
  <script>window.onload = main</script>
</head>
<body>
  <div id="vue-app">
    <h1>Calculator</h1>
    <h2>Correlation + Regression</h2>
    <!-- If result exists while there is an error, it is because a calculation failed -->
    <p id="error-message" v-if="error"><span v-if="result">Calculation Failed.</span> Error: {{ error }}</p>
    <div id="top-buttons">
      <input type="button" value="Reset Calculator" @click="resetCalculator">
      <input type="button" v-if="/Data Entry [1,2]/.test(displayScreen)" v-bind:value="inputMode === 'text' ? 'Switch to File Input' : 'Switch to Text Input'" @click="toggleInputMode">
    </div>
    
    <div class="app-screen" v-if="displayScreen === 'Data Entry 1' && inputMode === 'text'">
      <p>Please enter your first lot of data, separated by commas</p>
      
      <div class="data-input-container">
        <input class="data-input" v-model="inputString" @keyup.enter="processInput(1)"> <input type="button" class="data-submit" value="Submit Data" @click="processInput(1)">
      </div>
    </div>
    
    <div class="app-screen" v-if="displayScreen === 'Data Entry 1' && inputMode === 'file'">
      <p>Please load your first data file. Each data item should be on a new line.</p>
      
      <input type="file" @change="handleFileInput($event, 1)">
    </div>
    
    <div class="app-screen" v-else-if="displayScreen === 'Data Entry 2' && inputMode === 'text'">
      <p>Please enter your second lot of data, which must be the same length as the first, separated by commas</p>
      
      <div class="error-message">
        <p v-if="error">{{ error }}</p>
      </div>
      
      
      <div class="data-input-container">
        <input class="data-input" v-model="inputString" @keyup.enter="processInput(2)"> <input type="button" class="data-submit" value="Submit Data" @click="processInput(2)">
      </div>
    </div>
    
    <div class="app-screen" v-if="displayScreen === 'Data Entry 2' && inputMode === 'file'">
      <p>Please load your second data file. Please ensure both files have the same amount of numbers.</p>
      
      <input type="file" @change="handleFileInput($event, 2)">
    </div>
    
    <div class="app-screen" v-else-if="displayScreen === 'Choose Calculation'">
      <p>Would you like to calculate the correlation or the regression of your data?</p>
      <div id="calcType-btns">
        <input type="button" value="Correlation" @click="performCalculation('correlation')">
        <input type="button" value="Regression" @click="performCalculation('regression')">
      </div>
    </div>
    
    <div class="app-screen" v-else-if="displayScreen === 'Display Results'">
      <h3>{{ calcType }} calculated!</h3>
      
      <ul>
        <li v-for="(value, key) in result">{{ key }}: {{ value }}</li>
      </ul>
    </div>
    
    <div id="data-display">
      <data-table v-if="inputArrayOne" v-bind:data="inputArrayOne"></data-table>
      
      <data-table v-if="inputArrayTwo" v-bind:data="inputArrayTwo"></data-table>
    </div>
</body>